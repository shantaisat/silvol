{% extends 'base.html' %}

{% block content %}
  <h1>Volunteer Availability</h1>

  <!-- Display Availability in List Format -->
  <ul>
    {% for availability in availabilities %}
      <li>
        {{ availability.volunteer.username }}: 
        {{ availability.start_time }} to {{ availability.end_time }} - {{ availability.description }}
      <!-- Add Edit Availability Link -->
      <a href="{% url 'edit_availability' availability.id %}">Edit Availability</a>
      </li>
    {% endfor %}
  </ul>

  <!-- Calendar Display -->
  <div id="calendar"></div>

  <!-- FullCalendar CDN (Move to Base Template if Used in Multiple Pages) -->
 <!-- FullCalendar v5 Styles & Scripts -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.5/main.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.5/main.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script>
  document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');
  
      var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',  // Month view by default
          headerToolbar: {
              left: 'prev,next today',
              center: 'title',
              right: 'dayGridMonth,timeGridWeek,timeGridDay'
          },
          events: [
              {% for availability in availabilities %}
              {
                  title: '{{ availability.volunteer.username }}',
                  start: '{{ availability.start_time|date:"Y-m-d\TH:i:s" }}',
                  end: '{{ availability.end_time|date:"Y-m-d\TH:i:s" }}',
              },
              {% endfor %}
          ]
      });
  
      calendar.render();
  });
  </script>

{% endblock %}
